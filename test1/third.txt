this is the code of the new version