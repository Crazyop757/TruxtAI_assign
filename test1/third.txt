this is the code of the new versionfixed the bug in the third file